# v0.4.0-rc1 Release Notes

Release date: 2026-02-19

## Highlights

- Added response redaction for chat and streaming output paths.
- Added per-tenant token budget enforcement with deterministic `budget_exceeded` responses.
- Added non-blocking webhook notifications for governance and reliability signals.
- Added tracing diagnostics endpoint for request-level span inspection.
- Added Terraform validation workflow and module runbook.

## Runtime Behavior Changes

### Budget Enforcement

- New in-path budget gate applies before provider egress.
- Exceeded budgets return:
  - HTTP status: `429`
  - Error code: `budget_exceeded`
  - Existing error envelope shape preserved.

### Redaction

- Request redaction remains in-path pre-egress.
- Response redaction now scans outbound model content before returning to client.
- Audit events include:
  - `redaction_count` (aggregate)
  - `input_redaction_count`
  - `output_redaction_count`

### Tracing

- New endpoint:
  - `GET /v1/traces/{request_id}`
- Returns in-memory spans emitted for that request when tracing is enabled.

## Contracts

Updated `docs/contracts/v1/audit-event.schema.json` with optional fields:

- `trace_id`
- `budget`
- `webhook_events`
- `input_redaction_count`
- `output_redaction_count`

## New/Updated Environment Variables

- Budget:
  - `SRG_BUDGET_ENABLED`
  - `SRG_BUDGET_DEFAULT_CEILING`
  - `SRG_BUDGET_WINDOW_SECONDS`
  - `SRG_BUDGET_TENANT_CEILINGS`
- Webhooks:
  - `SRG_WEBHOOK_ENABLED`
  - `SRG_WEBHOOK_ENDPOINTS`
  - `SRG_WEBHOOK_TIMEOUT_S`
  - `SRG_WEBHOOK_MAX_RETRIES`
- Tracing:
  - `SRG_TRACING_ENABLED`
  - `SRG_TRACING_MAX_TRACES`

## Validation Summary

- Added unit coverage for budget tracker, webhook dispatcher, and span collector.
- Added integration coverage for:
  - budget deny + usage accounting
  - output redaction behavior
  - webhook trigger routing
  - trace endpoint required span chain

## Known Limitations

- Webhook delivery is best-effort and asynchronous; request path is never blocked by webhook failures.
- Span storage is in-memory only in this release candidate.
- SDK compatibility tests that bind ephemeral sockets may be environment-restricted in some local sandboxes; CI remains source of truth.
