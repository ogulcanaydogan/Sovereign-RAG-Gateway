# v0.3.0 Release Notes

Release date: 2026-02-19

## Highlights

- **True SSE streaming** for chat completions with `stream: true` — chunked transfer encoding,
  first-chunk validation, and audit written in a `finally` block to guarantee observability
  even on client disconnect or mid-stream provider errors.
- **Azure OpenAI provider adapter** with deployment-scoped endpoints and model normalization.
- **Anthropic Messages API adapter** with OpenAI-shape response normalization (system-to-assistant
  role mapping, usage extraction, finish reason translation).
- **Capability-aware provider routing** via `eligible_chain()` — filters providers by operation
  type (chat, embeddings, streaming) and model prefix support before fallback.
- **Three new RAG connectors** — S3 (JSONL index with local caching), Confluence (read-only,
  space filtering, BM25 scoring), and Jira (read-only, project key filtering, BM25 scoring).
- **Evidence replay bundles** with SHA-256 chain verification, tamper detection, and detached
  RSA signature output for forensic incident response.
- **Threat model and compliance mapping** documents with control-to-evidence traceability.

## Streaming and Provider Adapters

- Added `handle_chat_stream()` returning an async generator of SSE events with `text/event-stream`
  content type. Audit events, metrics, and logging execute in a `finally` block to guarantee
  observability even when the provider stream raises or the client disconnects.
- Added `AzureOpenAIProvider` — routes to Azure deployment endpoints, normalizes model names in
  both responses and stream chunks, and supports chat, embeddings, and streaming.
- Added `AnthropicProvider` — translates between the Anthropic Messages API format and the gateway's
  OpenAI-shape internal contract. Streaming is explicitly unsupported with a clear error.
- Added `ProviderCapabilities` dataclass with `chat`, `embeddings`, `streaming`, and
  `model_prefixes` fields for fine-grained provider eligibility filtering.
- Added `route_stream_with_fallback()` — streaming-aware fallback that validates the first chunk
  before committing to a provider, with automatic failover on retryable errors (429, 502, 503).

## RAG Connectors

- Added `S3Connector` — reads JSONL index files from S3 with prefix-based multi-object loading,
  local caching with configurable TTL, and last-known-good cache preservation on transient S3
  failures. BM25 token overlap scoring.
- Added `ConfluenceConnector` — read-only connector with Confluence REST API v2 pagination,
  space filtering, HTML body extraction, and BM25 scoring with cache TTL.
- Added `JiraConnector` — read-only connector with Jira REST API pagination (50 issues per page),
  project key filtering, ADF-to-text content parsing, and BM25 scoring with cache TTL.

## Evidence and Compliance

- Added `audit_replay_bundle.py` — extracts events for a given `request_id`, verifies the
  SHA-256 hash chain, and produces a self-contained evidence bundle JSON with metadata.
- Added `generate_release_evidence_artifacts.py` — generates a release evidence bundle with
  optional detached RSA signatures for non-repudiation.
- Added `evidence-bundle.schema.json` — JSON Schema contract for evidence bundle structure.
- Added threat model document with 12 threats, control mappings, and residual risk assessment.
- Added compliance control-to-evidence mapping with ISO 27001, SOC 2, and HIPAA traceability.
- Added incident replay runbook with step-by-step signed evidence procedure.

## Operations and Deployment

- Added EKS reference deployment guide with validated Kubernetes resource manifests.
- Added setup guides for Confluence and Jira connector configuration.
- Added `eks-reference-validate` CI workflow — validates EKS manifests offline.
- Added `evidence-replay-smoke` CI workflow — runs audit replay bundle generation in CI.

## Code Quality Improvements (v0.3.0 patch)

- Validated metric types in `check_benchmark_thresholds.py` before float cast — prevents stack
  traces on null or non-numeric metric values.
- Preserved last-known-good S3 cache on transient refresh failures — prevents cache poisoning
  with empty results.
- Fixed `isinstance(x, int | float | str)` PEP604 union syntax to tuple form `(int, float, str)`
  for runtime compatibility.
- Validated `model_prefixes` config — wraps bare strings in a list, filters non-string items,
  strips empty entries.
- Wrapped streaming `event_stream()` in `try/except BaseException/finally` — audit events and
  Prometheus metrics are now written even on client disconnect or mid-stream errors.
- Computed `citation_presence_rate` over RAG-expected denominator instead of defaulting to 1.0
  when no citations exist.

## Operational Notes

- Branch protection now requires `test`, `kind-helm-smoke`, `replay-smoke`, and `validate` checks.
- Provider configuration via `SRG_PROVIDER_CONFIG` JSON now supports `type: "azure_openai"` and
  `type: "anthropic"` in addition to `type: "openai_compatible"`.
- RAG connectors are auto-registered when their environment variables are set:
  `SRG_RAG_S3_BUCKET`, `SRG_RAG_CONFLUENCE_BASE_URL`, `SRG_RAG_JIRA_BASE_URL`.

## Benchmark and Evidence Links

- Benchmark runner: `scripts/benchmark_runner.py --scenario all`
- Threshold gates: `scripts/check_benchmark_thresholds.py`
- Evidence bundle: `scripts/audit_replay_bundle.py --request-id <id>`
- Weekly report: `docs/benchmarks/reports/weekly-2026-02-18.md`
