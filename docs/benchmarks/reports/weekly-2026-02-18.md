# Weekly Benchmark and Quality Report (2026-02-18)

## Scope
- Week-6 RC track for governed RAG.
- Added pgvector connector, provider-backed ingestion option, ranking quality gate, and migration checks.

## Test Summary
- `ruff check .`: pass
- `mypy app scripts`: pass
- `pytest`: pass (includes Postgres integration tests when `SRG_TEST_POSTGRES_DSN` is configured)
- `scripts/validate_schemas.py`: pass
- `scripts/compose_smoke.sh`: pass

## Benchmark Snapshot
- Gateway scenario runs: `direct_provider`, `observe_mode`, `enforce_redact`
- Citation eval dataset: `benchmarks/data/citation_eval.jsonl`
- Citation gate threshold: `>=0.95`
- PGVector ranking dataset: `benchmarks/data/pgvector_ranking_eval.jsonl`
- PGVector Recall@3 gate threshold: `>=0.80`
- Generated artifacts:
  - `artifacts/benchmarks/citation_eval.json`
  - `docs/benchmarks/reports/citations-latest.md`
  - `artifacts/benchmarks/pgvector_ranking_eval.json`
  - `docs/benchmarks/reports/pgvector-ranking-latest.md`

## Retrieval Snapshot
- Connector support: `filesystem`, `postgres`
- Ingestion commands:
  - `python3 scripts/generate_synthetic_healthcare_corpus.py --output-dir benchmarks/data/synthetic_corpus`
  - `python3 scripts/rag_ingest.py --input-dir benchmarks/data/synthetic_corpus --output artifacts/rag/filesystem_index.jsonl`
  - `python3 scripts/rag_ingest.py --connector postgres --input-dir benchmarks/data/synthetic_corpus --postgres-dsn <dsn>`
  - `python3 scripts/rag_ingest.py --connector postgres --embedding-source http --embedding-endpoint <openai-compatible-endpoint> --embedding-model text-embedding-3-small --embedding-api-key <key> ...`
- API behavior: RAG-enabled chat requests include `choices[].message.citations[]` for both filesystem and Postgres connectors.

## Known Limitations
- Hash-mode retrieval is lexical-hash baseline; provider embeddings require endpoint and API key configuration.
- Postgres connector assumes pgvector extension is available in target database.
- Benchmark harness still uses synthetic load characteristics.
